CREATE DATABASE BDPROYECTO;

CREATE TABLE USUARIOS(
	LOGIN VARCHAR(200),
	NOMBRE VARCHAR(200) NOT NULL,
	PASS VARCHAR(200) NOT NULL,
	EMAIL VARCHAR(200) NOT NULL,
	FOTO VARCHAR(200),
	CONSTRAINT PK_USUARIOS_LOGIN PRIMARY KEY (LOGIN)
)ENGINE="InnoDB";


CREATE TABLE ALUMNOS(
	NUMEXP INT(6) NOT NULL,
	DNI VARCHAR(9) NOT NULL  UNIQUE,
	NOMBRE VARCHAR(200) NOT NULL,
	TELEFONO INT(9),
	FOTO VARCHAR(200),
	CONSTRAINT PK_ALUMNOS_NUMEXP PRIMARY KEY (NUMEXP)
)ENGINE="InnoDB";


CREATE TABLE ASIGNATURAS(
	ID_ASIGNATURA INT(6) NOT NULL,
	NOMBRE VARCHAR(200),
	CONSTRAINT PK_ASIGNATURAS_IDNOTA PRIMARY KEY (ID_ASIGNATURA)
)ENGINE="InnoDB";


CREATE TABLE NOTAS(
	ID_NOTA INT(6) NOT NULL AUTO_INCREMENT,
	ID_ALUMNO INT(6) NOT NULL,
	ID_ASIGNATURA INT(6) NOT NULL,
	FECHA DATE NOT NULL,
	NOTA INT(5) NOT NULL,
	CONSTRAINT PK_NOTA_IDNAA PRIMARY KEY (ID_NOTA, ID_ALUMNO, ID_ASIGNATURA),
	CONSTRAINT FK_ALUMNO FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS(NUMEXP) ON DELETE CASCADE,
	CONSTRAINT FK_ASIGNATURAS FOREIGN KEY (ID_ASIGNATURA) REFERENCES ASIGNATURAS(ID_ASIGNATURA) ON DELETE CASCADE
)ENGINE="InnoDB";

-- DATOS
INSERT INTO USUARIOS VALUES("rodri", "rodrigo", "oscar6", "rodri@rodri.go", "rodri.jpg");
INSERT INTO USUARIOS VALUES("francis", "francis", "oscar6", "francis@rodri.go", "francis.jpg");

INSERT INTO ALUMNOS VALUES(111111, "11111111A", "Rodri", 111111111, "rodri.jpg");
INSERT INTO ALUMNOS VALUES(222222, "22222222S", "Pablo", 222222222, "pablo.jpg");
INSERT INTO ALUMNOS VALUES(333333, "33333333D", "Aaron", 333333333, "aaron.jpg");
INSERT INTO ALUMNOS VALUES(444444, "44444444F", "Pedro", 444444444, "pedro.jpg");
INSERT INTO ALUMNOS VALUES(555555, "55555555G", "Carlos", 555555555, "carlos.jpg");
INSERT INTO ALUMNOS VALUES(666666, "66666666H", "Jeff", 666666666, "jeff.jpg");

INSERT INTO ASIGNATURAS VALUES(1, "ASO");
INSERT INTO ASIGNATURAS VALUES(2, "SRI");
INSERT INTO ASIGNATURAS VALUES(3, "IAW");
INSERT INTO ASIGNATURAS VALUES(4, "SRI");
INSERT INTO ASIGNATURAS VALUES(5, "ASGBD");

INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(111111, 1, '2017-10-2', 9);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(222222, 1, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(333333, 1, '2017-10-2', 5);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(444444, 1, '2017-10-2', 8);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(555555, 1, '2017-10-2', 6);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(666666, 1, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(111111, 2, '2017-10-2', 9);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(222222, 2, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(333333, 2, '2017-10-2', 5);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(444444, 2, '2017-10-2', 8);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(555555, 2, '2017-10-2', 6);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(666666, 2, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(111111, 3, '2017-10-2', 9);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(222222, 3, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(333333, 3, '2017-10-2', 5);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(444444, 3, '2017-10-2', 8);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(555555, 3, '2017-10-2', 6);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(666666, 3, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(111111, 4, '2017-10-2', 9);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(222222, 4, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(333333, 4, '2017-10-2', 5);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(444444, 4, '2017-10-2', 8);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(555555, 4, '2017-10-2', 6);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(666666, 4, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(111111, 5, '2017-10-2', 9);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(222222, 5, '2017-10-2', 7);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(333333, 5, '2017-10-2', 5);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(444444, 5, '2017-10-2', 8);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(555555, 5, '2017-10-2', 6);
INSERT INTO NOTAS (ID_ALUMNO,ID_ASIGNATURA, FECHA, NOTA) VALUES(666666, 5, '2017-10-2', 7);


-- ALGUNAS CONSULTAS
/*LAS NOTAS DE UN USUARIO EN CADA ASIGNATURA*/
SELECT ALUMNOS.NOMBRE, ASIGNATURAS.NOMBRE, NOTAS.NOTA, NOTAS.FECHA
FROM ALUMNOS, ASIGNATURAS, NOTAS
WHERE ALUMNOS.NUMEXP = NOTAS.ID_ALUMNO 
AND ASIGNATURAS.ID_ASIGNATURA = NOTAS.ID_ASIGNATURA
AND ALUMNOS.NUMEXP = 222222;

SELECT 